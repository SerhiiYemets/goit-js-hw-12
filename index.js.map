{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '52724963-1b39cb743cbbccbbd6e65dea0';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page) {\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page,\n                per_page: 15,\n            }\n        });\n\n        if (!response.data.hits) {\n            throw new Error('Unexpected API response format');\n        }\n\n        return response.data;\n    }\n\n    catch (error) {\n        console.error('Error:', error);\n        throw error;\n    }\n}\n\n\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const gallery = document.querySelector('.gallery')\n\nconst loadBth = document.querySelector('.button-load')\nconst loader = document.querySelector('.loader')\n\nlet lightbox;\n\nexport function createGallery (images) {\n    const galleryMarkup = images\n        .map(\n            ({\n                webformatURL,\n                largeImageURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads,\n            }) => {\n                return `\n                <li class=\"gallery-item\">\n                    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n                    <div class=\"image-info\">\n                        <p class=\"image-item\">\n                            <span class=\"info-label\">Likes</span>\n                            <span class=\"info-value\">${likes}</span>\n                        </p>\n                        <p class=\"image-item\">\n                            <span class=\"info-label\">Views</span>\n                            <span class=\"info-value\">${views}</span>\n                        </p>\n                        <p class=\"image-item\">\n                            <span class=\"info-label\">Comments</span>\n                            <span class=\"info-value\">${comments}</span>\n                        </p>\n                        <p class=\"image-item\">\n                            <span class=\"info-label\">Downloads</span>\n                            <span class=\"info-value\">${downloads}</span>\n                        </p>\n                </div>\n            </a>\n        </li>\n        `;\n    }).join('');\n    \n    gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n    \n    if (!lightbox) {\n        lightbox = new SimpleLightbox('.gallery a', {\n            captionsData: 'alt',\n            captionDelay: 250,\n            close: true,\n        });\n    } else {\n        lightbox.refresh();\n    }\n}\n\nexport function clearGallery() {\n    gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n    loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n    loader.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n    loadBth.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton() {\n    loadBth.classList.add('hidden');\n}\n\n\n","import { getImagesByQuery } from './js/pixabay-api.js';\n\nimport {\n    createGallery,\n    clearGallery,\n    showLoader,\n    hideLoader,\n    showLoadMoreButton,\n    hideLoadMoreButton,\n    gallery,\n} from \"./js/render-functions\";\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('form');\nconst input = form.elements['search-text'];\nconst loadBth = document.querySelector('.button-load');\n\nlet currentQuery = '';\nlet currentPage = 1;\nlet totalHits = 0;\n\nform.addEventListener('submit', onSearch)\nloadBth.addEventListener('click', onLoadMore);\n\nhideLoadMoreButton();\n\nasync function onSearch(event) {\n    event.preventDefault();\n    currentQuery = input.value.trim();\n    currentPage = 1;\n    totalHits = 0;\n\n    clearGallery();\n    hideLoadMoreButton();\n    showLoader();\n\n\n    if (currentQuery === '') {\n        iziToast.error({\n            title: 'Error',\n            message: 'Please enter a search query.',\n            position: 'topRight',\n        });\n        hideLoader();\n        return;\n    }\n\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        if (!data || !Array.isArray(data.hits)) {\n            iziToast.error({\n                message: 'Received incorrect data while loading additional images. Please try again.',\n                position: 'topRight',\n            });\n            hideLoader();\n            return;\n        }\n        totalHits = data.totalHits;\n\n        if (data.hits.length === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n            });\n            hideLoader();\n            return;\n        }\n\n        createGallery(data.hits);\n        hideLoader();\n\n        checkEndOfTheCollection();\n    } catch (error) {\n        console.log('catch', error);\n        iziToast.error({\n            message: 'Try again!',\n            position: 'topRight',\n        });\n        hideLoader();\n    } finally {\n        input.value = '';\n    }\n}\n\nasync function onLoadMore() {\n    currentPage += 1;\n    showLoader();\n    hideLoadMoreButton();\n\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage);\n        if (!data || !Array.isArray(data.hits)) {\n            iziToast.error({\n                message: 'Received incorrect data while loading additional images. Please try again.',\n                position: 'topRight',\n            });\n            hideLoader();\n            showLoadMoreButton();\n            return;\n        }\n\n        createGallery(data.hits);\n        hideLoader();\n        checkEndOfTheCollection();\n        scrollToNextGroup();\n    }\n    \n    catch (error) {\n        console.log('catch', error);\n        iziToast.error({\n            message: 'An error occurred while loading more images',\n            position: 'topRight',\n        });\n        hideLoader();\n        showLoadMoreButton();\n    }\n}\n\nfunction checkEndOfTheCollection() {\n    const loadedImagesCount = currentPage * 15;\n\n    if (loadedImagesCount >= totalHits) {\n        hideLoadMoreButton();\n        iziToast.info({\n            message: \"We're sorry, but you've reached the end  of  search results.\",\n        });\n    } else {\n        showLoadMoreButton();\n    }\n}\n\nfunction scrollToNextGroup() {\n    const firstGalleryItem = gallery.firstElementChild;\n    if (firstGalleryItem) {\n        const itemHeight = firstGalleryItem.getBoundingClientRect().height;\n        window.scrollBy({\n            top: itemHeight * 2,\n            behavior: 'smooth',\n        });\n    }\n}\n\n\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","response","axios","error","gallery","loadBth","loader","lightbox","createGallery","images","galleryMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","input","currentQuery","currentPage","totalHits","onSearch","onLoadMore","event","iziToast","data","checkEndOfTheCollection","scrollToNextGroup","firstGalleryItem","itemHeight"],"mappings":"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"}